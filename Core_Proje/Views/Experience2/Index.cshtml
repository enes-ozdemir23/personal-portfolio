@using EntityLayer.Concrete
@model List<Experience>
@{
	ViewData["Title"] = "Index";
	Layout = "~/Views/Shared/_NewAdminLayout.cshtml";
}

<div class="col-md-6">
	<div class="p-2">
		<button type="button" id="btngetlistall" class="btn btn-outline-primary">Verileri Getir</button>
		<button type="button" id="btnadd" class="btn btn-outline-info">Kaydet</button>
		<button type="button" id="btnid" class="btn btn-outline-warning">Id ile Getir</button>
		<button type="button" id="btndelete" class="btn btn-outline-danger">Sil</button>
		<button type="button" id="btnupdate" class="btn btn-outline-success">Güncelle</button>
	</div>
</div>
<div class="p-2" id="listexperience">
</div>
<br />
<div class="p-2" id="listbyidexperience">
</div>

<div class="col-md-12">
	<h5>Ekleme Paneli</h5>
	<input type="text" class="form-control" id="inpname" placeholder="Başlık" />
	<br />
	<input type="text" class="form-control" id="inpdate" placeholder="Tarih" />
</div>
<br />
<div class="col-md-12">
	<h5>Id'ye Göre Getirme Paneli</h5>
	<input type="text" class="form-control" id="inpid" placeholder="ID Giriniz" />
</div>
<br />
<div class="col-md-12">
	<h5>Silme Paneli</h5>
	<input type="text" class="form-control" id="inpexid" placeholder="ID Giriniz" />
</div>
<div class="col-md-12">
	<h5>Güncelleme Paneli</h5>
	<input type="text" id="upID" class="form-control" placeholder="ID" />
	<br>
	<input type="text" id="upName" class="form-control" placeholder="Başlık" />
	<br>
	<input type="text" id="upDate" class="form-control" placeholder="Tarih" />
</div>

@section Scripts
{
	<script>

		$("#btngetlistall").click(function () {

			$.ajax({
				type: "GET",
				url: "/Experience2/ListExperience",
				success: function (values) {

					console.log(values); // önce console’dan veriyi kontrol et

					let html = `
						<table class="table table-bordered">
							<tr>
								<th>ID</th>
								<th>Başlık</th>
								<th>Tarih</th>
							</tr>
					`;

					// data → JSON array oluyor
					values.forEach(x => {
						html += `
							<tr>
								<td>${x.experienceID}</td>
								<td>${x.name}</td>
								<td>${x.date}</td>
							</tr>
						`;
					});

					html += "</table>";

					$("#listexperience").html(html);
				}
			});

		});

		$("#btnadd").click(function(){
			let values={
				Name: $("#inpname").val(),
				Date: $("#inpdate").val()
			};

			$.ajax({
				type:"POST",
				url:"/Experience2/AddExperience/",
				data:values,
				success:function(result){
					alert("Başarılı Bir Şekilde Eklendi");
				}
			});
		});

		$("#btnid").click(x=>{
			let id=$("#inpid").val();

			$.ajax({
				type:"GET",
				url:"/Experience2/GetById/",
				data:{ExperienceID:id},
				success:function(result){
					console.log(result);
					let htmlstr=`<table class=table table hover> <tr><th>Deneyim ID</th> <td>
					${result.experienceID}</td></tr> <tr><th> Deneyim Başlığı </th> <td>
					${result.name}</td></tr></table>`;
					$("#listbyidexperience").html(htmlstr);

				}
			});
		});

		$("#btndelete").click(x=>{
			let id=$("#inpexid").val();
			$.ajax({
				url:"/Experience2/DeleteExperience/"+id,
				type:"POST",
				success:function(funk3){
					loadData();
				}

			});
		});

		//update için otomatik doldurma
		$("#upID").on("change keyup", function () {
			let id = $(this).val();

			if (id === "") return;

			$.ajax({
				type: "GET",
				url: "/Experience2/GetById/",
				data: { ExperienceID: id },
				success: function (result) {
					$("#upID").val(result.experienceID);
					$("#upName").val(result.name);
					$("#upDate").val(result.date);
				}
			});
		});

		$("#btnupdate").click(function () {

			let data = {
				ExperienceID: $("#upID").val(),
				Name: $("#upName").val(),
				Date: $("#upDate").val()
			};

			$.ajax({
				type: "POST",
				url: "/Experience2/UpdateExperience/",
				data: data,
				success: function (res) {
					alert("Güncelleme başarılı!");
				}
			});

		});


	</script>
}

<script src="~/lib/jquery/dist/jquery.js"></script>
